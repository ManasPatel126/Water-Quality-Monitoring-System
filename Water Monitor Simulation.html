<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ESP32 AquaMonitor â€” Complete Guide</title>
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Rajdhani:wght@300;400;500;600;700&family=Exo+2:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #040c18;
  --panel: #071220;
  --card: #0a1828;
  --border: #0d2540;
  --border2: #142e50;
  --accent: #00d4ff;
  --accent2: #00ff9d;
  --warn: #ffb800;
  --danger: #ff3355;
  --purple: #b060ff;
  --orange: #ff7b30;
  --yellow: #f0d060;
  --text: #b8d4f0;
  --dim: #3a5878;
  --dim2: #5a7898;
}
*{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}
body{background:var(--bg);font-family:'Exo 2',sans-serif;color:var(--text);min-height:100vh;overflow-x:hidden;}
body::before{content:'';position:fixed;top:0;left:0;right:0;bottom:0;background:repeating-linear-gradient(0deg,transparent,transparent 3px,rgba(0,212,255,0.008) 3px,rgba(0,212,255,0.008) 4px);pointer-events:none;z-index:1000;}

/* â”€â”€â”€ HEADER â”€â”€â”€ */
header{padding:12px 32px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;background:rgba(4,12,24,0.95);position:sticky;top:0;z-index:200;backdrop-filter:blur(12px);}
.logo{display:flex;align-items:center;gap:12px;}
.logo-mark{width:38px;height:38px;border:2px solid var(--accent);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:18px;position:relative;animation:logoGlow 3s ease-in-out infinite;}
@keyframes logoGlow{0%,100%{box-shadow:0 0 10px rgba(0,212,255,0.3),inset 0 0 10px rgba(0,212,255,0.05)}50%{box-shadow:0 0 25px rgba(0,212,255,0.6),inset 0 0 20px rgba(0,212,255,0.1)}}
.logo-text h1{font-family:'Rajdhani',sans-serif;font-size:20px;font-weight:700;color:var(--accent);letter-spacing:3px;}
.logo-text p{font-size:9px;color:var(--dim2);letter-spacing:3px;text-transform:uppercase;}
.hdr-right{display:flex;align-items:center;gap:16px;}
.live-badge{display:flex;align-items:center;gap:6px;font-family:'Share Tech Mono',monospace;font-size:10px;color:var(--accent2);background:rgba(0,255,157,0.05);border:1px solid rgba(0,255,157,0.15);padding:5px 10px;border-radius:20px;}
.live-dot{width:6px;height:6px;border-radius:50%;background:var(--accent2);animation:blink 1.5s infinite;}
@keyframes blink{0%,100%{opacity:1}50%{opacity:0.2}}
.dl-btn{display:flex;align-items:center;gap:6px;background:linear-gradient(135deg,rgba(0,212,255,0.15),rgba(0,255,157,0.1));border:1px solid rgba(0,212,255,0.3);color:var(--accent);padding:7px 16px;border-radius:8px;font-family:'Rajdhani',sans-serif;font-size:13px;font-weight:600;letter-spacing:1px;cursor:pointer;transition:all 0.2s;text-transform:uppercase;}
.dl-btn:hover{background:linear-gradient(135deg,rgba(0,212,255,0.25),rgba(0,255,157,0.18));box-shadow:0 0 16px rgba(0,212,255,0.2);}

/* â”€â”€â”€ TABS â”€â”€â”€ */
.tabs{display:flex;border-bottom:1px solid var(--border);background:rgba(7,18,32,0.9);position:sticky;top:64px;z-index:100;backdrop-filter:blur(8px);}
.tab{padding:14px 32px;font-family:'Rajdhani',sans-serif;font-size:13px;font-weight:600;letter-spacing:2px;text-transform:uppercase;cursor:pointer;color:var(--dim2);border-bottom:2px solid transparent;transition:all 0.25s;display:flex;align-items:center;gap:8px;}
.tab:hover{color:var(--text);}
.tab.active{color:var(--accent);border-bottom-color:var(--accent);background:rgba(0,212,255,0.04);}
.tab-content{display:none;}
.tab-content.active{display:block;animation:fadeIn 0.3s ease;}
@keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}

/* â”€â”€â”€ SHARED â”€â”€â”€ */
.sec-title{font-family:'Rajdhani',sans-serif;font-size:11px;letter-spacing:4px;text-transform:uppercase;color:var(--accent);margin-bottom:18px;display:flex;align-items:center;gap:10px;}
.sec-title::after{content:'';flex:1;height:1px;background:linear-gradient(90deg,var(--border2),transparent);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GUIDE TAB
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.guide-wrap{max-width:960px;margin:0 auto;padding:32px 28px;}

.guide-hero{background:linear-gradient(135deg,rgba(0,212,255,0.06),rgba(0,255,157,0.04));border:1px solid var(--border2);border-radius:14px;padding:28px 32px;margin-bottom:36px;position:relative;overflow:hidden;}
.guide-hero::before{content:'';position:absolute;top:-40px;right:-40px;width:180px;height:180px;background:radial-gradient(circle,rgba(0,212,255,0.08),transparent 70%);pointer-events:none;}
.guide-hero h2{font-family:'Rajdhani',sans-serif;font-size:26px;font-weight:700;color:var(--accent);letter-spacing:2px;margin-bottom:8px;}
.guide-hero p{font-size:14px;color:var(--dim2);line-height:1.7;max-width:700px;}

/* steps */
.steps-list{display:flex;flex-direction:column;gap:24px;margin-bottom:40px;}
.step-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:22px 24px;position:relative;overflow:hidden;transition:border-color 0.3s;}
.step-card:hover{border-color:var(--border2);}
.step-card::before{content:'';position:absolute;left:0;top:0;bottom:0;width:3px;background:var(--accent);border-radius:3px 0 0 3px;}
.step-num{position:absolute;top:18px;right:20px;font-family:'Share Tech Mono',monospace;font-size:32px;font-weight:700;color:var(--accent);opacity:0.07;line-height:1;}
.step-badge{display:inline-flex;align-items:center;gap:6px;background:rgba(0,212,255,0.08);border:1px solid rgba(0,212,255,0.15);color:var(--accent);font-size:10px;letter-spacing:2px;padding:3px 10px;border-radius:20px;margin-bottom:10px;font-family:'Rajdhani',sans-serif;font-weight:600;}
.step-card h3{font-family:'Rajdhani',sans-serif;font-size:17px;font-weight:700;color:var(--text);margin-bottom:10px;letter-spacing:1px;}
.step-card p,.step-card li{font-size:13px;color:var(--dim2);line-height:1.8;}
.step-card ul{padding-left:20px;margin-top:8px;}
.step-card li{margin-bottom:4px;}
.step-card li span{color:var(--text);}
.highlight-box{background:rgba(0,255,157,0.04);border:1px solid rgba(0,255,157,0.12);border-radius:8px;padding:12px 16px;margin-top:12px;}
.highlight-box p{font-family:'Share Tech Mono',monospace;font-size:11px;color:var(--accent2);line-height:1.9;}
.warn-box{background:rgba(255,184,0,0.04);border:1px solid rgba(255,184,0,0.15);border-radius:8px;padding:12px 16px;margin-top:12px;}
.warn-box p{font-size:12px;color:var(--warn);line-height:1.7;}
.img-placeholder{background:var(--panel);border:1px dashed var(--border2);border-radius:8px;padding:12px;margin-top:12px;text-align:center;font-size:11px;color:var(--dim);font-family:'Share Tech Mono',monospace;}

/* component cards */
.comp-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px;margin-bottom:40px;}
.comp-card{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:18px;transition:all 0.2s;}
.comp-card:hover{border-color:var(--border2);transform:translateY(-2px);}
.comp-card-icon{font-size:28px;margin-bottom:10px;}
.comp-card h4{font-family:'Rajdhani',sans-serif;font-size:15px;font-weight:700;color:var(--accent);margin-bottom:6px;letter-spacing:1px;}
.comp-card p{font-size:12px;color:var(--dim2);line-height:1.7;}
.comp-card .comp-pin{margin-top:10px;font-family:'Share Tech Mono',monospace;font-size:10px;color:var(--accent2);background:rgba(0,255,157,0.05);padding:6px 10px;border-radius:5px;border:1px solid rgba(0,255,157,0.1);}

/* water knowledge */
.param-cards{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:20px;margin-bottom:40px;}
.param-card{background:var(--card);border:1px solid var(--border);border-radius:12px;overflow:hidden;}
.param-card-head{padding:16px 20px;display:flex;align-items:center;gap:12px;}
.param-icon{font-size:26px;}
.param-card-head h3{font-family:'Rajdhani',sans-serif;font-size:17px;font-weight:700;letter-spacing:1px;}
.param-card-body{padding:0 20px 18px;}
.param-card-body p{font-size:12px;color:var(--dim2);line-height:1.8;margin-bottom:10px;}
.param-ranges{display:flex;flex-direction:column;gap:6px;}
.range-row{display:flex;align-items:center;justify-content:space-between;padding:5px 10px;border-radius:6px;font-size:11px;font-family:'Share Tech Mono',monospace;}
.range-row.safe{background:rgba(0,255,157,0.06);border:1px solid rgba(0,255,157,0.12);color:var(--accent2);}
.range-row.warn{background:rgba(255,184,0,0.06);border:1px solid rgba(255,184,0,0.12);color:var(--warn);}
.range-row.danger{background:rgba(255,51,85,0.06);border:1px solid rgba(255,51,85,0.12);color:var(--danger);}
.range-bar-wrap{margin:10px 0;height:8px;background:var(--border);border-radius:4px;position:relative;overflow:visible;}
.range-safe-zone{position:absolute;height:100%;border-radius:4px;background:linear-gradient(90deg,rgba(0,255,157,0.3),rgba(0,255,157,0.5));top:0;}
.effects-list{margin-top:10px;}
.effects-list li{font-size:11px;color:var(--dim2);line-height:1.8;padding-left:12px;position:relative;}
.effects-list li::before{content:'â†’';position:absolute;left:0;color:var(--accent);font-size:10px;}

/* ph color scale */
.ph-scale{display:flex;height:14px;border-radius:7px;overflow:hidden;margin:10px 0;}
.ph-seg{flex:1;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CIRCUIT TAB
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.circuit-wrap{padding:24px 30px;}
.circuit-svg-box{background:var(--panel);border:1px solid var(--border);border-radius:14px;padding:20px;overflow-x:auto;margin-bottom:24px;}
svg.circuit{width:100%;max-width:900px;display:block;margin:0 auto;}
.comp-label{font-family:'Share Tech Mono',monospace;font-size:11px;fill:var(--text);}
.comp-sublabel{font-family:'Share Tech Mono',monospace;font-size:9px;fill:var(--dim2);}
.pin-label{font-family:'Share Tech Mono',monospace;font-size:8px;}
.wire-label{font-family:'Share Tech Mono',monospace;font-size:8px;}
.legend{display:flex;flex-wrap:wrap;gap:18px;margin-bottom:24px;}
.legend-item{display:flex;align-items:center;gap:8px;font-size:12px;}
.legend-line{width:30px;height:3px;border-radius:2px;}
.pinout-table{border-collapse:collapse;width:100%;max-width:700px;}
.pinout-table th{text-align:left;padding:8px 14px;font-size:10px;letter-spacing:2px;text-transform:uppercase;color:var(--accent);border-bottom:1px solid var(--border);}
.pinout-table td{padding:9px 14px;font-size:12px;border-bottom:1px solid var(--border);font-family:'Share Tech Mono',monospace;}
.pinout-table td:first-child{color:var(--accent2);}
.pinout-table td:last-child{color:var(--dim2);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SIMULATION TAB
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.sim-grid{display:grid;grid-template-columns:1fr 380px;min-height:calc(100vh - 112px);}
.controls-panel{padding:24px 28px;border-right:1px solid var(--border);}
.sensors-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:24px;}
.sensor-card{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:16px;position:relative;overflow:hidden;transition:all 0.3s;}
.sensor-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:var(--accent);opacity:0.5;transition:background 0.3s;}
.sensor-card.warn::before{background:var(--warn);}
.sensor-card.danger::before{background:var(--danger);}
.sensor-card.safe::before{background:var(--accent2);}
.sensor-label{font-size:9px;letter-spacing:3px;text-transform:uppercase;color:var(--dim);margin-bottom:5px;}
.sensor-value{font-family:'Share Tech Mono',monospace;font-size:28px;font-weight:700;color:var(--accent);transition:color 0.3s;line-height:1;}
.sensor-unit{font-size:10px;color:var(--dim);margin-top:4px;}
.sensor-status{font-size:9px;margin-top:6px;padding:2px 8px;border-radius:20px;display:inline-block;background:rgba(0,255,157,0.08);color:var(--accent2);border:1px solid rgba(0,255,157,0.15);letter-spacing:1px;transition:all 0.3s;}
.sensor-status.warn{background:rgba(255,184,0,0.08);color:var(--warn);border-color:rgba(255,184,0,0.2);}
.sensor-status.danger{background:rgba(255,51,85,0.08);color:var(--danger);border-color:rgba(255,51,85,0.2);}
.slider-block{margin-bottom:20px;}
.slider-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;}
.slider-name{font-size:12px;font-weight:600;}
.slider-readout{font-family:'Share Tech Mono',monospace;font-size:12px;color:var(--accent);background:rgba(0,212,255,0.05);padding:2px 10px;border-radius:4px;border:1px solid rgba(0,212,255,0.1);}
input[type=range]{width:100%;-webkit-appearance:none;height:4px;background:var(--border2);border-radius:2px;outline:none;}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:16px;height:16px;border-radius:50%;background:var(--accent);cursor:pointer;box-shadow:0 0 8px rgba(0,212,255,0.5);}
.tick-labels{display:flex;justify-content:space-between;font-size:9px;color:var(--dim);margin-top:4px;}
.report-panel{padding:22px;background:rgba(4,12,24,0.6);}
.overall-badge{padding:16px;border-radius:10px;text-align:center;margin-bottom:14px;border:2px solid;transition:all 0.5s;}
.overall-badge.safe{border-color:var(--accent2);background:rgba(0,255,157,0.04);}
.overall-badge.warn{border-color:var(--warn);background:rgba(255,184,0,0.04);}
.overall-badge.danger{border-color:var(--danger);background:rgba(255,51,85,0.04);}
.badge-emoji{font-size:28px;margin-bottom:5px;}
.badge-title{font-family:'Rajdhani',sans-serif;font-size:15px;font-weight:700;letter-spacing:2px;}
.badge-sub{font-size:10px;color:var(--dim2);margin-top:4px;}
.wqi-bar{margin-bottom:14px;}
.wqi-label{display:flex;justify-content:space-between;margin-bottom:6px;font-size:11px;}
.wqi-track{height:7px;background:var(--border);border-radius:4px;overflow:hidden;}
.wqi-fill{height:100%;border-radius:4px;transition:width 0.5s ease;background:linear-gradient(90deg,var(--danger),var(--warn),var(--accent2));}
.report-table{width:100%;border-collapse:collapse;margin-bottom:14px;}
.report-table tr{border-bottom:1px solid var(--border);}
.report-table td{padding:9px 4px;font-size:12px;vertical-align:middle;}
.report-table td:first-child{color:var(--dim);font-size:10px;letter-spacing:1px;text-transform:uppercase;width:90px;}
.report-table td:nth-child(2){font-family:'Share Tech Mono',monospace;color:var(--accent);font-weight:600;}
.tag{display:inline-block;padding:2px 7px;border-radius:4px;font-size:9px;letter-spacing:1px;font-weight:600;}
.tag.safe{background:rgba(0,255,157,0.12);color:var(--accent2);}
.tag.warn{background:rgba(255,184,0,0.12);color:var(--warn);}
.tag.danger{background:rgba(255,51,85,0.12);color:var(--danger);}
.serial-monitor{background:#020810;border:1px solid var(--border);border-radius:8px;padding:12px;font-family:'Share Tech Mono',monospace;font-size:10px;max-height:180px;overflow-y:auto;}
.serial-header{font-size:9px;letter-spacing:3px;text-transform:uppercase;color:var(--dim);margin-bottom:8px;}
.serial-line{margin-bottom:2px;line-height:1.6;}
.serial-line.snew{color:var(--accent2);}
.serial-line.swarn{color:var(--warn);}
.serial-line.sdanger{color:var(--danger);}
.serial-line.shead{color:var(--accent);}
.serial-line.sdim{color:var(--dim2);}



@media(max-width:860px){.sim-grid{grid-template-columns:1fr}.sensors-grid{grid-template-columns:1fr 1fr}.tab{padding:10px 16px;font-size:11px;}}
</style>
</head>
<body>

<!-- PRINT PDF STYLES -->
<style id="print-styles">
@media print {
  body * { visibility: hidden !important; }
  #pdf-report, #pdf-report * { visibility: visible !important; }
  #pdf-report { position: fixed; top: 0; left: 0; width: 100%; z-index: 9999; background: white !important; }
  @page { margin: 15mm; size: A4; }
}
</style>

<!-- PDF REPORT TEMPLATE (hidden, shown only during print) -->
<div id="pdf-report" style="display:none; font-family: 'Courier New', monospace; background: white; color: #111; padding: 32px; max-width: 720px; margin: 0 auto;">

  <!-- Header -->
  <div style="border-bottom: 3px solid #0077aa; padding-bottom: 16px; margin-bottom: 24px; display:flex; justify-content:space-between; align-items:flex-end;">
    <div>
      <div style="font-size:22px; font-weight:900; color:#0077aa; letter-spacing:3px;">ğŸ’§ AQUAMONITOR</div>
      <div style="font-size:11px; color:#555; letter-spacing:2px; margin-top:3px;">ESP32 WATER QUALITY ANALYSIS REPORT</div>
    </div>
    <div style="text-align:right; font-size:11px; color:#777;">
      <div id="pdf-date">â€”</div>
      <div style="margin-top:2px;">ESP32 DevKit V1 Â· v1.0</div>
    </div>
  </div>

  <!-- Overall Status Badge -->
  <div id="pdf-badge" style="border-radius:10px; padding:18px 24px; margin-bottom:24px; text-align:center; border:2px solid #00aa66; background:#f0fff8;">
    <div id="pdf-badge-emoji" style="font-size:32px; margin-bottom:4px;">âœ…</div>
    <div id="pdf-badge-title" style="font-size:18px; font-weight:900; letter-spacing:2px; color:#00aa66;">SAFE TO DRINK</div>
    <div id="pdf-badge-sub" style="font-size:11px; color:#555; margin-top:4px;">All parameters within WHO safe range</div>
    <div style="margin-top:10px; font-size:12px; color:#333;">Water Quality Index: <strong id="pdf-wqi" style="font-size:16px;">â€”</strong> / 100</div>
  </div>

  <!-- Sensor Readings Table -->
  <div style="margin-bottom:24px;">
    <div style="font-size:11px; letter-spacing:3px; text-transform:uppercase; color:#0077aa; font-weight:700; border-bottom:1px solid #ddd; padding-bottom:6px; margin-bottom:12px;">SENSOR READINGS</div>
    <table style="width:100%; border-collapse:collapse; font-size:13px;">
      <thead>
        <tr style="background:#f0f7ff;">
          <th style="padding:9px 12px; text-align:left; font-size:10px; letter-spacing:1px; color:#555; border:1px solid #ddd;">PARAMETER</th>
          <th style="padding:9px 12px; text-align:left; font-size:10px; letter-spacing:1px; color:#555; border:1px solid #ddd;">MEASURED VALUE</th>
          <th style="padding:9px 12px; text-align:left; font-size:10px; letter-spacing:1px; color:#555; border:1px solid #ddd;">STATUS</th>
          <th style="padding:9px 12px; text-align:left; font-size:10px; letter-spacing:1px; color:#555; border:1px solid #ddd;">WHO SAFE RANGE</th>
          <th style="padding:9px 12px; text-align:left; font-size:10px; letter-spacing:1px; color:#555; border:1px solid #ddd;">SENSOR / GPIO</th>
        </tr>
      </thead>
      <tbody id="pdf-table-body">
      </tbody>
    </table>
  </div>

  <!-- Analysis Section -->
  <div style="margin-bottom:24px;">
    <div style="font-size:11px; letter-spacing:3px; text-transform:uppercase; color:#0077aa; font-weight:700; border-bottom:1px solid #ddd; padding-bottom:6px; margin-bottom:12px;">PARAMETER ANALYSIS</div>
    <div id="pdf-analysis" style="font-size:12px; color:#333; line-height:1.9;"></div>
  </div>

  <!-- WHO Reference -->
  <div style="margin-bottom:24px; background:#f9f9f9; border:1px solid #ddd; border-radius:8px; padding:16px;">
    <div style="font-size:11px; letter-spacing:3px; text-transform:uppercase; color:#0077aa; font-weight:700; margin-bottom:10px;">WHO DRINKING WATER GUIDELINES REFERENCE</div>
    <table style="width:100%; border-collapse:collapse; font-size:11px;">
      <tr><td style="padding:5px 8px; color:#555; width:120px;">pH</td><td style="padding:5px 8px;">6.5 â€“ 8.5 (Ideal: 6.5â€“7.5)</td><td style="padding:5px 8px; color:#007744;">Affects taste, pipe corrosion, disinfection effectiveness</td></tr>
      <tr style="background:#f0f0f0;"><td style="padding:5px 8px; color:#555;">TDS</td><td style="padding:5px 8px;">&lt; 500 ppm (Ideal: 100â€“300)</td><td style="padding:5px 8px; color:#007744;">Measures dissolved minerals, salts, metals</td></tr>
      <tr><td style="padding:5px 8px; color:#555;">Turbidity</td><td style="padding:5px 8px;">&lt; 4 NTU (Ideal: &lt;1 NTU)</td><td style="padding:5px 8px; color:#007744;">Cloudiness; shields pathogens from disinfection</td></tr>
      <tr style="background:#f0f0f0;"><td style="padding:5px 8px; color:#555;">Temperature</td><td style="padding:5px 8px;">5 â€“ 30 Â°C (Ideal: 10â€“25)</td><td style="padding:5px 8px; color:#007744;">Affects bacterial growth and chemical reactions</td></tr>
    </table>
  </div>

  <!-- Circuit Info -->
  <div style="margin-bottom:24px;">
    <div style="font-size:11px; letter-spacing:3px; text-transform:uppercase; color:#0077aa; font-weight:700; border-bottom:1px solid #ddd; padding-bottom:6px; margin-bottom:12px;">HARDWARE CONFIGURATION</div>
    <table style="width:100%; border-collapse:collapse; font-size:11px;">
      <tr><td style="padding:5px 8px; color:#555; width:160px;">Microcontroller</td><td style="padding:5px 8px;">ESP32 DevKit V1 (CP2102 USB-UART)</td></tr>
      <tr style="background:#f9f9f9;"><td style="padding:5px 8px; color:#555;">pH Sensor</td><td style="padding:5px 8px;">Analog pH Module â†’ GPIO34 (ADC input-only)</td></tr>
      <tr><td style="padding:5px 8px; color:#555;">TDS Sensor</td><td style="padding:5px 8px;">TDS Module â†’ GPIO35 (ADC input-only)</td></tr>
      <tr style="background:#f9f9f9;"><td style="padding:5px 8px; color:#555;">Turbidity Sensor</td><td style="padding:5px 8px;">Turbidity Module â†’ GPIO32 (ADC)</td></tr>
      <tr><td style="padding:5px 8px; color:#555;">Temperature Sensor</td><td style="padding:5px 8px;">DS18B20 1-Wire Probe â†’ GPIO4 (4.7kÎ© pull-up)</td></tr>
      <tr style="background:#f9f9f9;"><td style="padding:5px 8px; color:#555;">Power Source</td><td style="padding:5px 8px;">18650 Li-ion 3.7V / 3000mAh (via TP4056)</td></tr>
    </table>
  </div>

  <!-- Footer -->
  <div style="border-top:2px solid #0077aa; padding-top:12px; display:flex; justify-content:space-between; font-size:10px; color:#999;">
    <div>AquaMonitor ESP32 Simulation Â· Based on WHO Drinking Water Quality Guidelines (2022)</div>
    <div id="pdf-footer-date">â€”</div>
  </div>
</div>

<!-- HEADER -->
<header>
  <div class="logo">
    <div class="logo-mark">ğŸ’§</div>
    <div class="logo-text">
      <h1>AQUAMONITOR</h1>
      <p>ESP32 Water Quality System</p>
    </div>
  </div>
  <div class="hdr-right">
    <div class="live-badge"><div class="live-dot"></div>SIMULATION LIVE</div>
    <button class="dl-btn" onclick="downloadPDF()">â¬‡ Download PDF Report</button>
  </div>
</header>

<!-- TABS -->
<div class="tabs">
  <div class="tab active" onclick="switchTab('guide')">ğŸ“– Guide</div>
  <div class="tab" onclick="switchTab('circuit')">âš¡ Circuit Diagram</div>
  <div class="tab" onclick="switchTab('sim')">ğŸ“Š Live Simulation</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• GUIDE TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="tab-guide" class="tab-content active">
<div class="guide-wrap">

  <div class="guide-hero">
    <h2>COMPLETE ASSEMBLY GUIDE</h2>
    <p>Step-by-step instructions for building the ESP32 Water Quality Monitor on a breadboard â€” from first component placement to running your simulation. No soldering required.</p>
  </div>

  <!-- COMPONENTS SECTION -->
  <div class="sec-title">Component Overview & Functions</div>
  <div class="comp-grid">
    <div class="comp-card">
      <div class="comp-card-icon">ğŸ§ </div>
      <h4>ESP32 DevKit V1</h4>
      <p>The brain of the project. A microcontroller with built-in WiFi and Bluetooth. Reads all sensors via its GPIO pins, processes the data, and can upload results to the cloud via WiFi. The CP2102 chip onboard handles USB-to-serial communication for programming.</p>
      <div class="comp-pin">VIN=5V Â· 3V3=3.3V Â· GND Â· GPIO 4,32,34,35</div>
    </div>
    <div class="comp-card">
      <div class="comp-card-icon">ğŸŒ¡ï¸</div>
      <h4>DS18B20 Temperature Probe</h4>
      <p>Digital waterproof temperature sensor accurate to Â±0.5Â°C. Uses the 1-Wire protocol â€” meaning only ONE data wire is needed. Ideal for submerging in water samples. The flat side faces you when reading pin labels.</p>
      <div class="comp-pin">Pin 1=GND Â· Pin 2=DQ(Data) Â· Pin 3=VCC</div>
    </div>
    <div class="comp-card">
      <div class="comp-card-icon">ğŸ§ª</div>
      <h4>pH Sensor Module (Analog)</h4>
      <p>Measures how acidic or alkaline the water is. Contains a glass pH electrode and a signal amplifier board. Outputs an analog voltage (0â€“3.3V) proportional to pH. Requires calibration with buffer solutions for real-world use.</p>
      <div class="comp-pin">VCC=3.3V Â· GND Â· Po/SIG â†’ GPIO34</div>
    </div>
    <div class="comp-card">
      <div class="comp-card-icon">âš—ï¸</div>
      <h4>TDS Sensor Module</h4>
      <p>Measures Total Dissolved Solids â€” minerals, salts, metals dissolved in water. Two metal probes pass a small current through water; higher conductivity = higher TDS. Outputs analog voltage read by ESP32 ADC on GPIO35.</p>
      <div class="comp-pin">VCC=3.3V Â· GND Â· AOUT â†’ GPIO35</div>
    </div>
    <div class="comp-card">
      <div class="comp-card-icon">ğŸŒŠ</div>
      <h4>Turbidity Sensor</h4>
      <p>Measures water clarity using an infrared LED and photodetector. Murky water scatters more light, reducing the signal received. Higher turbidity = more suspended particles. Analog output connected to GPIO32.</p>
      <div class="comp-pin">VCC=5V Â· GND Â· AOUT â†’ GPIO32</div>
    </div>
    <div class="comp-card">
      <div class="comp-card-icon">ğŸ”´</div>
      <h4>4.7kÎ© Pull-up Resistor</h4>
      <p>Required by the DS18B20's 1-Wire protocol. It "pulls up" the data line to VCC when idle. Without this resistor, the sensor gives incorrect/no readings. Color bands: Yellow-Violet-Red-Gold. Connect between DQ pin and 3.3V.</p>
      <div class="comp-pin">Between GPIO4 (DQ) and 3.3V</div>
    </div>
    <div class="comp-card">
      <div class="comp-card-icon">ğŸ”‹</div>
      <h4>18650 Li-ion Battery (3000mAh)</h4>
      <p>Rechargeable 3.7V lithium-ion cell that powers the project portably. Use a TP4056 charging module for safe charging and protection. In simulation, powers the 3.3V and 5V rails via ESP32's onboard regulator.</p>
      <div class="comp-pin">+ terminal â†’ VIN Â· âˆ’ terminal â†’ GND</div>
    </div>
    <div class="comp-card">
      <div class="comp-card-icon">ğŸ”Œ</div>
      <h4>CP2102 USB-to-UART</h4>
      <p>Built into the ESP32 DevKit. Converts USB signals from your computer to UART serial signals the ESP32 understands. Used only during programming â€” when you click Upload in Arduino IDE, data flows through this chip.</p>
      <div class="comp-pin">Onboard â€” connects via micro-USB</div>
    </div>
  </div>

  <!-- STEP BY STEP -->
  <div class="sec-title">Step-by-Step Breadboard Assembly</div>
  <div class="steps-list">

    <div class="step-card">
      <div class="step-num">01</div>
      <div class="step-badge">STEP 01 Â· PREPARATION</div>
      <h3>Gather Tools & Understand the Breadboard</h3>
      <p>Before placing any component, understand how a breadboard works:</p>
      <ul>
        <li>The breadboard has <span>horizontal power rails</span> on top and bottom (marked + and âˆ’). All holes in a single rail are connected.</li>
        <li>The <span>middle section</span> has vertical columns (aâ€“e on left, fâ€“j on right). Each column of 5 holes is connected internally.</li>
        <li>The <span>center gap</span> (trench) separates left and right halves â€” ICs and ESP32 straddle this gap.</li>
      </ul>
      <div class="highlight-box"><p>You need: Breadboard (830 holes recommended) Â· ESP32 Â· DS18B20 Â· pH Module Â· TDS Module Â· Turbidity Sensor Â· 4.7kÎ© resistor Â· Jumper wires (M-M)</p></div>
    </div>

    <div class="step-card">
      <div class="step-num">02</div>
      <div class="step-badge">STEP 02 Â· ESP32 PLACEMENT</div>
      <h3>Place the ESP32 on the Breadboard</h3>
      <p>The ESP32 is the widest component and goes in the center:</p>
      <ul>
        <li>Orient the ESP32 so the <span>USB port faces downward (toward you)</span>.</li>
        <li>Straddle it across the center trench â€” left pins in columns <span>e</span>, right pins in columns <span>f</span>.</li>
        <li>Place it starting around <span>row 5</span>, leaving space above for sensor wires.</li>
        <li>Press firmly until all pins are fully seated â€” you should feel a slight click.</li>
        <li>The antenna end (no USB) should face away from you at the top.</li>
      </ul>
      <div class="warn-box"><p>âš ï¸ Make sure NO two pins of the ESP32 share the same row. If they do, they'll short circuit. The ESP32 is wide enough that left and right pins naturally land in separate rows.</p></div>
    </div>

    <div class="step-card">
      <div class="step-num">03</div>
      <div class="step-badge">STEP 03 Â· POWER RAILS</div>
      <h3>Set Up the Power and Ground Rails</h3>
      <p>Connect the ESP32's power pins to the breadboard rails so all sensors can tap into them:</p>
      <ul>
        <li>Find the <span>3V3 pin</span> on the ESP32 (labeled on the board). Connect a <span>RED wire</span> from this pin to the <span>+ rail</span> at the top of the breadboard.</li>
        <li>Find any <span>GND pin</span> on the ESP32. Connect a <span>BLACK wire</span> from it to the <span>âˆ’ rail</span> at the top.</li>
        <li>On the far end of the breadboard, use two short jumper wires to <span>bridge the top + rail to the bottom + rail</span>, and top âˆ’ to bottom âˆ’. This extends power access to both sides.</li>
      </ul>
      <div class="highlight-box"><p>RED wire = 3.3V (VCC)   BLACK wire = Ground (GND)   Always use these color conventions!</p></div>
    </div>

    <div class="step-card">
      <div class="step-num">04</div>
      <div class="step-badge">STEP 04 Â· DS18B20 TEMPERATURE SENSOR</div>
      <h3>Connect the DS18B20 Probe</h3>
      <p>The DS18B20 looks like a black cylinder with 3 legs. Hold it with the <span>flat face toward you</span> to identify pins:</p>
      <ul>
        <li><span>Left pin (Pin 1) = GND</span> â†’ Connect black wire to âˆ’ rail</li>
        <li><span>Middle pin (Pin 2) = DQ (Data)</span> â†’ Connect blue/green wire to ESP32 <span>GPIO4</span></li>
        <li><span>Right pin (Pin 3) = VCC</span> â†’ Connect red wire to + rail</li>
      </ul>
      <p style="margin-top:10px;">Place the sensor in an empty section of the breadboard (e.g., rows 20â€“22). Insert each leg into a separate row.</p>
      <div class="warn-box"><p>âš ï¸ CRITICAL: You MUST add the 4.7kÎ© pull-up resistor between Pin 2 (DQ) and VCC (3.3V). Without it, the sensor returns garbage values or âˆ’127Â°C. Place the resistor horizontally connecting the DQ row to the + rail row.</p></div>
    </div>

    <div class="step-card">
      <div class="step-num">05</div>
      <div class="step-badge">STEP 05 Â· pH SENSOR MODULE</div>
      <h3>Connect the pH Sensor Module</h3>
      <p>The pH module is a small green/blue PCB (not the probe itself â€” the probe plugs into the PCB). It has 3 pins: VCC, GND, and Po (analog out):</p>
      <ul>
        <li>Place the module in a free section of breadboard or connect via jumper wires from its header.</li>
        <li><span>VCC â†’ + rail (3.3V)</span> â€” red wire</li>
        <li><span>GND â†’ âˆ’ rail</span> â€” black wire</li>
        <li><span>Po / SIG â†’ ESP32 GPIO34</span> â€” yellow wire</li>
      </ul>
      <div class="highlight-box"><p>GPIO34 is INPUT-ONLY on ESP32 (no internal pull-up). This makes it perfect for analog sensors. Never try to set it as OUTPUT.</p></div>
      <div class="warn-box"><p>âš ï¸ GPIO34 and GPIO35 are input-only ADC pins. Do not connect them to 5V â€” maximum 3.3V or you will damage the ESP32.</p></div>
    </div>

    <div class="step-card">
      <div class="step-num">06</div>
      <div class="step-badge">STEP 06 Â· TDS SENSOR MODULE</div>
      <h3>Connect the TDS Sensor Module</h3>
      <p>The TDS module also has a PCB with 3 output pins and a separate probe with two metal rods:</p>
      <ul>
        <li><span>VCC â†’ 3.3V rail</span> â€” red wire</li>
        <li><span>GND â†’ GND rail</span> â€” black wire</li>
        <li><span>AOUT â†’ ESP32 GPIO35</span> â€” orange wire</li>
      </ul>
      <p style="margin-top:8px;">Place the module's PCB near the pH module to keep the wiring tidy. The TDS probe (two metal rods) should be submerged in the water sample during actual use â€” in simulation, a potentiometer replaces this.</p>
    </div>

    <div class="step-card">
      <div class="step-num">07</div>
      <div class="step-badge">STEP 07 Â· TURBIDITY SENSOR</div>
      <h3>Connect the Turbidity Sensor</h3>
      <p>The turbidity sensor module has a U-shaped optical head and a PCB with 3 pins:</p>
      <ul>
        <li><span>VCC â†’ 3.3V rail</span> â€” red wire (some modules use 5V â€” check your specific module)</li>
        <li><span>GND â†’ GND rail</span> â€” black wire</li>
        <li><span>OUT/AOUT â†’ ESP32 GPIO32</span> â€” purple wire</li>
      </ul>
      <p style="margin-top:8px;">Place the turbidity sensor module adjacent to the TDS module. The optical head should be positioned so it can be inserted into the water container in real deployment.</p>
      <div class="highlight-box"><p>GPIO32 supports ADC (Analog-to-Digital Conversion). It reads the 0â€“3.3V analog signal and maps it to a 12-bit value (0â€“4095) representing turbidity.</p></div>
    </div>

    <div class="step-card">
      <div class="step-num">08</div>
      <div class="step-badge">STEP 08 Â· BATTERY</div>
      <h3>Connect the 18650 Battery (Optional for Portable Use)</h3>
      <p>For portable operation (away from USB power):</p>
      <ul>
        <li>Place the 18650 battery in its holder.</li>
        <li>Connect the <span>+ terminal of the battery holder â†’ VIN pin</span> of the ESP32 (accepts 5Vâ€“12V).</li>
        <li>Connect the <span>âˆ’ terminal â†’ GND pin</span> of the ESP32.</li>
        <li>Recommended: Use a <span>TP4056 module</span> between the battery and ESP32 for overcharge/overdischarge protection.</li>
      </ul>
      <div class="warn-box"><p>âš ï¸ During programming/simulation, leave the battery disconnected and power the ESP32 only via USB. Only connect the battery for standalone field deployment.</p></div>
    </div>

    <div class="step-card">
      <div class="step-num">09</div>
      <div class="step-badge">STEP 09 Â· WOKWI SIMULATION</div>
      <h3>Run in Wokwi (No Hardware Needed)</h3>
      <p>To simulate before building physically:</p>
      <ul>
        <li>Go to <span>wokwi.com</span> â†’ New Project â†’ ESP32</li>
        <li>Replace <span>sketch.ino</span> content with the provided Arduino code</li>
        <li>Replace <span>diagram.json</span> content with the provided circuit JSON</li>
        <li><span>Delete wokwi.toml</span> if it exists (causes library errors)</li>
        <li>Click â–¶ Play â€” Wokwi auto-installs OneWire and DallasTemperature libraries</li>
        <li>Open Serial Monitor at the bottom â€” turn potentiometer knobs to simulate sensors</li>
      </ul>
      <div class="highlight-box"><p>In Wokwi: Potentiometer 1 = pH sensor   Potentiometer 2 = TDS sensor   Potentiometer 3 = Turbidity sensor   DS18B20 = Temperature sensor</p></div>
    </div>

    <div class="step-card">
      <div class="step-num">10</div>
      <div class="step-badge">STEP 10 Â· PROGRAMMING</div>
      <h3>Upload Code via Arduino IDE</h3>
      <p>To program the physical ESP32:</p>
      <ul>
        <li>Install <span>Arduino IDE 2.x</span> from arduino.cc</li>
        <li>In Arduino IDE: File â†’ Preferences â†’ add this URL to Board Manager: <code style="font-size:10px;color:var(--accent2)">https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json</code></li>
        <li>Tools â†’ Board Manager â†’ search "esp32" â†’ Install <span>esp32 by Espressif Systems</span></li>
        <li>Tools â†’ Board â†’ select <span>"ESP32 Dev Module"</span></li>
        <li>Tools â†’ Port â†’ select your COM port (appears when ESP32 is plugged in)</li>
        <li>Install libraries: Sketch â†’ Include Library â†’ Manage Libraries â†’ install <span>OneWire</span> and <span>DallasTemperature</span></li>
        <li>Paste the sketch code â†’ click Upload (â†’ arrow)</li>
        <li>Open Serial Monitor (Ctrl+Shift+M), set baud to <span>115200</span></li>
      </ul>
    </div>
  </div>

  <!-- WATER KNOWLEDGE SECTION -->
  <div class="sec-title">Water Quality Parameters â€” Science & Safe Limits</div>
  <div class="param-cards">

    <!-- pH -->
    <div class="param-card">
      <div class="param-card-head" style="background:linear-gradient(135deg,rgba(0,212,255,0.08),rgba(0,255,157,0.04));border-bottom:1px solid var(--border);">
        <div class="param-icon">ğŸ§ª</div>
        <div><h3 style="color:var(--accent);">pH Level</h3><div style="font-size:10px;color:var(--dim2);">Acidity / Alkalinity Scale</div></div>
      </div>
      <div class="param-card-body">
        <div class="ph-scale">
          <div class="ph-seg" style="background:#dc2626;"></div>
          <div class="ph-seg" style="background:#ea580c;"></div>
          <div class="ph-seg" style="background:#d97706;"></div>
          <div class="ph-seg" style="background:#ca8a04;"></div>
          <div class="ph-seg" style="background:#84cc16;"></div>
          <div class="ph-seg" style="background:#16a34a;"></div>
          <div class="ph-seg" style="background:#15803d;"></div>
          <div class="ph-seg" style="background:#0d9488;"></div>
          <div class="ph-seg" style="background:#0891b2;"></div>
          <div class="ph-seg" style="background:#2563eb;"></div>
          <div class="ph-seg" style="background:#4f46e5;"></div>
          <div class="ph-seg" style="background:#7c3aed;"></div>
          <div class="ph-seg" style="background:#9d174d;"></div>
          <div class="ph-seg" style="background:#881337;"></div>
        </div>
        <div style="display:flex;justify-content:space-between;font-size:9px;color:var(--dim2);margin-bottom:12px;"><span>0 ACID</span><span style="color:var(--accent2);">7 NEUTRAL</span><span>14 ALKALINE</span></div>
        <p><strong style="color:var(--text);">What it measures:</strong> pH quantifies how acidic or basic water is on a 0â€“14 scale. 7 is neutral (pure water). Below 7 = acidic, above 7 = alkaline/basic.</p>
        <p><strong style="color:var(--text);">Why it matters:</strong> pH affects taste, pipe corrosion, effectiveness of chlorine disinfection, and heavy metal solubility. Extreme pH damages mucous membranes and digestive tract.</p>
        <div class="param-ranges">
          <div class="range-row safe">âœ… 6.5 â€“ 8.5 <span>WHO Drinking Water Safe Limit</span></div>
          <div class="range-row safe">âœ… 6.5 â€“ 7.5 <span>Ideal/Optimal Range</span></div>
          <div class="range-row warn">âš ï¸ 6.0 â€“ 6.5 <span>Slightly Acidic â€” Corrosive to pipes</span></div>
          <div class="range-row warn">âš ï¸ 8.5 â€“ 9.0 <span>Mildly Alkaline â€” Bitter taste</span></div>
          <div class="range-row danger">âŒ &lt; 6.0 <span>Acidic â€” Leaches metals, harmful</span></div>
          <div class="range-row danger">âŒ &gt; 9.0 <span>Highly Alkaline â€” Gastrointestinal damage</span></div>
        </div>
        <ul class="effects-list" style="margin-top:12px;">
          <li>Low pH (acidic) can leach lead and copper from pipes into water</li>
          <li>High pH reduces chlorine disinfection effectiveness by 90%+</li>
          <li>Most fish die if water pH drops below 5.0</li>
          <li>Acid rain has pH as low as 4.2</li>
        </ul>
      </div>
    </div>

    <!-- TDS -->
    <div class="param-card">
      <div class="param-card-head" style="background:linear-gradient(135deg,rgba(251,146,60,0.08),rgba(240,210,96,0.04));border-bottom:1px solid var(--border);">
        <div class="param-icon">âš—ï¸</div>
        <div><h3 style="color:var(--orange);">TDS â€” Total Dissolved Solids</h3><div style="font-size:10px;color:var(--dim2);">Mineral & Contaminant Content</div></div>
      </div>
      <div class="param-card-body">
        <p><strong style="color:var(--text);">What it measures:</strong> TDS measures the total concentration of all dissolved substances in water â€” including minerals (calcium, magnesium, potassium), salts, metals, and organic matter. Measured in parts per million (ppm) or mg/L.</p>
        <p><strong style="color:var(--text);">Why it matters:</strong> TDS affects taste, hardness, and safety. Too low = tasteless, lacks essential minerals. Too high = bitter/salty taste, possible toxic heavy metals or nitrates.</p>
        <div class="param-ranges">
          <div class="range-row safe">âœ… 50 â€“ 150 ppm <span>Excellent â€” Very pure</span></div>
          <div class="range-row safe">âœ… 150 â€“ 500 ppm <span>Good â€” WHO Acceptable Limit</span></div>
          <div class="range-row warn">âš ï¸ 500 â€“ 900 ppm <span>Fair â€” Noticeable taste change</span></div>
          <div class="range-row danger">âŒ &gt; 900 ppm <span>Poor â€” WHO Not Recommended</span></div>
          <div class="range-row danger">âŒ &gt; 1200 ppm <span>Unacceptable â€” WHO Max Limit</span></div>
          <div class="range-row warn">âš ï¸ &lt; 50 ppm <span>Too Low â€” Lacks minerals, flat taste</span></div>
        </div>
        <ul class="effects-list" style="margin-top:12px;">
          <li>RO (Reverse Osmosis) filtered water often has TDS 5â€“20 ppm â€” too low to be ideal</li>
          <li>Seawater TDS is ~35,000 ppm â€” undrinkable</li>
          <li>High TDS can indicate agricultural runoff (nitrates, pesticides)</li>
          <li>Mineral water typically has TDS 300â€“500 ppm</li>
          <li>Hard water (TDS 200+) can cause kidney stones with long-term consumption</li>
        </ul>
      </div>
    </div>

    <!-- Turbidity -->
    <div class="param-card">
      <div class="param-card-head" style="background:linear-gradient(135deg,rgba(96,132,255,0.08),rgba(176,96,255,0.04));border-bottom:1px solid var(--border);">
        <div class="param-icon">ğŸŒŠ</div>
        <div><h3 style="color:#6084ff;">Turbidity</h3><div style="font-size:10px;color:var(--dim2);">Water Clarity / Cloudiness</div></div>
      </div>
      <div class="param-card-body">
        <p><strong style="color:var(--text);">What it measures:</strong> Turbidity measures how much light is scattered by suspended particles in water. Measured in NTU (Nephelometric Turbidity Units). Higher NTU = cloudier water = more suspended particles.</p>
        <p><strong style="color:var(--text);">Why it matters:</strong> Turbid water harbors pathogens that hide behind particles and evade UV/chlorine disinfection. It's one of the most important indicators of water treatment quality.</p>
        <div class="param-ranges">
          <div class="range-row safe">âœ… 0 â€“ 1 NTU <span>Excellent â€” Crystal clear</span></div>
          <div class="range-row safe">âœ… 1 â€“ 4 NTU <span>WHO Maximum Acceptable</span></div>
          <div class="range-row warn">âš ï¸ 4 â€“ 10 NTU <span>Noticeable cloudiness â€” Treat</span></div>
          <div class="range-row danger">âŒ 10 â€“ 100 NTU <span>Very cloudy â€” Unsafe to drink</span></div>
          <div class="range-row danger">âŒ &gt; 100 NTU <span>Opaque â€” Severely contaminated</span></div>
        </div>
        <ul class="effects-list" style="margin-top:12px;">
          <li>Floodwater turbidity can exceed 1000 NTU</li>
          <li>Municipal tap water is usually &lt; 0.3 NTU after treatment</li>
          <li>Turbidity acts as a shield for bacteria against chlorine disinfection</li>
          <li>High turbidity correlates with cholera, typhoid, and cryptosporidium outbreaks</li>
          <li>The sensor used here (optical) can be blocked by dirt â€” clean regularly</li>
        </ul>
      </div>
    </div>

    <!-- Temperature -->
    <div class="param-card">
      <div class="param-card-head" style="background:linear-gradient(135deg,rgba(255,51,85,0.06),rgba(255,184,0,0.04));border-bottom:1px solid var(--border);">
        <div class="param-icon">ğŸŒ¡ï¸</div>
        <div><h3 style="color:#ff6080;">Temperature</h3><div style="font-size:10px;color:var(--dim2);">Thermal State of Water</div></div>
      </div>
      <div class="param-card-body">
        <p><strong style="color:var(--text);">What it measures:</strong> Water temperature in degrees Celsius using the DS18B20 digital probe. Temperature influences chemical reaction rates, oxygen levels, bacterial growth, and the accuracy of other sensor readings.</p>
        <p><strong style="color:var(--text);">Why it matters:</strong> Bacteria multiply rapidly between 25â€“50Â°C. Hot water can also dissolve pipe material (lead, copper) faster. Cold water holds more dissolved oxygen, which is better for aquatic life.</p>
        <div class="param-ranges">
          <div class="range-row safe">âœ… 10 â€“ 25 Â°C <span>Ideal for drinking water</span></div>
          <div class="range-row safe">âœ… 5 â€“ 30 Â°C <span>WHO Acceptable Range</span></div>
          <div class="range-row warn">âš ï¸ 30 â€“ 35 Â°C <span>Warm â€” Promotes bacterial growth</span></div>
          <div class="range-row danger">âŒ &gt; 35 Â°C <span>Hot â€” High bacterial risk</span></div>
          <div class="range-row warn">âš ï¸ &lt; 5 Â°C <span>Cold â€” Risk of pipe freezing</span></div>
        </div>
        <ul class="effects-list" style="margin-top:12px;">
          <li>Legionella bacteria thrive and multiply at 25â€“45Â°C</li>
          <li>Temperature directly affects pH and dissolved oxygen readings</li>
          <li>Higher temperature reduces chlorine residual in distribution systems</li>
          <li>Water taste is best between 10â€“15Â°C (cool but not cold)</li>
          <li>DS18B20 needs 750ms conversion time for accurate reading</li>
        </ul>
      </div>
    </div>

  </div>

  <!-- Quick Reference -->
  <div class="sec-title">WHO Quick Reference â€” Safe Limits Summary</div>
  <div style="background:var(--card);border:1px solid var(--border);border-radius:12px;overflow:hidden;margin-bottom:32px;">
    <table style="width:100%;border-collapse:collapse;">
      <tr style="background:rgba(0,212,255,0.06);">
        <th style="padding:12px 16px;text-align:left;font-size:10px;letter-spacing:2px;color:var(--accent);border-bottom:1px solid var(--border);">PARAMETER</th>
        <th style="padding:12px 16px;text-align:left;font-size:10px;letter-spacing:2px;color:var(--accent);border-bottom:1px solid var(--border);">SAFE RANGE</th>
        <th style="padding:12px 16px;text-align:left;font-size:10px;letter-spacing:2px;color:var(--accent);border-bottom:1px solid var(--border);">IDEAL</th>
        <th style="padding:12px 16px;text-align:left;font-size:10px;letter-spacing:2px;color:var(--accent);border-bottom:1px solid var(--border);">MAX LIMIT</th>
        <th style="padding:12px 16px;text-align:left;font-size:10px;letter-spacing:2px;color:var(--accent);border-bottom:1px solid var(--border);">SENSOR USED</th>
      </tr>
      <tr style="border-bottom:1px solid var(--border);">
        <td style="padding:12px 16px;font-family:'Share Tech Mono',monospace;font-size:13px;color:var(--accent2);">pH</td>
        <td style="padding:12px 16px;font-size:12px;">6.5 â€“ 8.5</td>
        <td style="padding:12px 16px;font-size:12px;color:var(--accent2);">6.5 â€“ 7.5</td>
        <td style="padding:12px 16px;font-size:12px;color:var(--warn);">9.0</td>
        <td style="padding:12px 16px;font-size:11px;color:var(--dim2);">Analog pH Module â†’ GPIO34</td>
      </tr>
      <tr style="border-bottom:1px solid var(--border);">
        <td style="padding:12px 16px;font-family:'Share Tech Mono',monospace;font-size:13px;color:var(--orange);">TDS</td>
        <td style="padding:12px 16px;font-size:12px;">50 â€“ 500 ppm</td>
        <td style="padding:12px 16px;font-size:12px;color:var(--accent2);">100 â€“ 300 ppm</td>
        <td style="padding:12px 16px;font-size:12px;color:var(--warn);">1200 ppm</td>
        <td style="padding:12px 16px;font-size:11px;color:var(--dim2);">TDS Module â†’ GPIO35</td>
      </tr>
      <tr style="border-bottom:1px solid var(--border);">
        <td style="padding:12px 16px;font-family:'Share Tech Mono',monospace;font-size:13px;color:#6084ff;">Turbidity</td>
        <td style="padding:12px 16px;font-size:12px;">0 â€“ 4 NTU</td>
        <td style="padding:12px 16px;font-size:12px;color:var(--accent2);">&lt; 1 NTU</td>
        <td style="padding:12px 16px;font-size:12px;color:var(--warn);">5 NTU</td>
        <td style="padding:12px 16px;font-size:11px;color:var(--dim2);">Turbidity Sensor â†’ GPIO32</td>
      </tr>
      <tr>
        <td style="padding:12px 16px;font-family:'Share Tech Mono',monospace;font-size:13px;color:#ff6080;">Temperature</td>
        <td style="padding:12px 16px;font-size:12px;">5 â€“ 30 Â°C</td>
        <td style="padding:12px 16px;font-size:12px;color:var(--accent2);">10 â€“ 25 Â°C</td>
        <td style="padding:12px 16px;font-size:12px;color:var(--warn);">35 Â°C</td>
        <td style="padding:12px 16px;font-size:11px;color:var(--dim2);">DS18B20 â†’ GPIO4</td>
      </tr>
    </table>
  </div>

</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CIRCUIT TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="tab-circuit" class="tab-content">
<div class="circuit-wrap">
  <div class="sec-title">Breadboard Circuit â€” ESP32 Water Quality Monitor</div>
  <div class="circuit-svg-box">
    <svg class="circuit" viewBox="0 0 900 520" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <filter id="glow"><feGaussianBlur stdDeviation="2.5" result="blur"/><feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
        <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse"><path d="M 20 0 L 0 0 0 20" fill="none" stroke="#0d2540" stroke-width="0.5" opacity="0.5"/></pattern>
      </defs>
      <rect width="900" height="520" fill="#040c18"/>
      <rect width="900" height="520" fill="url(#grid)"/>
      <!-- ESP32 -->
      <rect x="335" y="155" width="225" height="210" rx="8" fill="#071220" stroke="#00d4ff" stroke-width="1.5" filter="url(#glow)"/>
      <rect x="340" y="160" width="215" height="200" rx="6" fill="#0a1828"/>
      <text x="447" y="202" text-anchor="middle" class="comp-label" fill="#00d4ff" font-size="14" font-weight="700">ESP32</text>
      <text x="447" y="216" text-anchor="middle" class="comp-sublabel">DevKit V1</text>
      <text x="447" y="234" text-anchor="middle" fill="#00d4ff" font-size="9" opacity="0.4">WiFi Â· Bluetooth Â· CP2102</text>
      <rect x="415" y="142" width="65" height="15" rx="4" fill="#071220" stroke="#00d4ff" stroke-width="1"/>
      <text x="447" y="153" text-anchor="middle" font-size="8" fill="#00d4ff" opacity="0.6">ANTENNA</text>
      <!-- Left pins -->
      <rect x="316" y="188" width="21" height="8" rx="2" fill="#0d1f3c" stroke="#4a6b8a" stroke-width="0.5"/><text x="312" y="195" text-anchor="end" class="pin-label" fill="#4a6b8a">GND</text>
      <rect x="316" y="203" width="21" height="8" rx="2" fill="#0d1f3c" stroke="#4a6b8a" stroke-width="0.5"/><text x="312" y="210" text-anchor="end" class="pin-label" fill="#dc2626">3V3</text>
      <rect x="316" y="218" width="21" height="8" rx="2" fill="#0d1f3c" stroke="#00d4ff" stroke-width="0.8"/><text x="312" y="225" text-anchor="end" class="pin-label" fill="#00d4ff">GPIO4</text>
      <rect x="316" y="233" width="21" height="8" rx="2" fill="#0d1f3c" stroke="#c084fc" stroke-width="0.8"/><text x="312" y="240" text-anchor="end" class="pin-label" fill="#c084fc">GPIO32</text>
      <!-- Right pins -->
      <rect x="558" y="188" width="21" height="8" rx="2" fill="#0d1f3c" stroke="#f0d060" stroke-width="0.8"/><text x="583" y="195" class="pin-label" fill="#f0d060">GPIO34</text>
      <rect x="558" y="203" width="21" height="8" rx="2" fill="#0d1f3c" stroke="#ff7b30" stroke-width="0.8"/><text x="583" y="210" class="pin-label" fill="#ff7b30">GPIO35</text>
      <rect x="558" y="218" width="21" height="8" rx="2" fill="#0d1f3c" stroke="#4a6b8a" stroke-width="0.5"/><text x="583" y="225" class="pin-label" fill="#dc2626">3V3</text>
      <rect x="558" y="233" width="21" height="8" rx="2" fill="#0d1f3c" stroke="#4a6b8a" stroke-width="0.5"/><text x="583" y="240" class="pin-label" fill="#4a6b8a">GND</text>
      <rect x="423" y="355" width="48" height="12" rx="3" fill="#0d1f3c" stroke="#4a6b8a" stroke-width="1"/>
      <text x="447" y="365" text-anchor="middle" font-size="8" fill="#4a6b8a">USB / CP2102</text>
      <!-- DS18B20 -->
      <ellipse cx="98" cy="215" rx="26" ry="38" fill="#0d1f3c" stroke="#00d4ff" stroke-width="1.5" filter="url(#glow)"/>
      <text x="98" y="211" text-anchor="middle" class="comp-label" fill="#00d4ff" font-size="9">DS18B20</text>
      <text x="98" y="222" text-anchor="middle" class="comp-sublabel">Temp</text>
      <line x1="82" y1="252" x2="82" y2="285" stroke="#1e293b" stroke-width="2"/>
      <line x1="98" y1="252" x2="98" y2="285" stroke="#00d4ff" stroke-width="2"/>
      <line x1="114" y1="252" x2="114" y2="285" stroke="#dc2626" stroke-width="2"/>
      <text x="82" y="296" text-anchor="middle" class="pin-label" fill="#4a6b8a">GND</text>
      <text x="98" y="296" text-anchor="middle" class="pin-label" fill="#00d4ff">DQ</text>
      <text x="114" y="296" text-anchor="middle" class="pin-label" fill="#dc2626">VCC</text>
      <!-- 4.7k Resistor -->
      <rect x="142" y="214" width="48" height="16" rx="4" fill="#2a1a0a" stroke="#a16207" stroke-width="1.5"/>
      <line x1="142" y1="222" x2="136" y2="222" stroke="#a16207" stroke-width="1.5"/>
      <line x1="190" y1="222" x2="196" y2="222" stroke="#a16207" stroke-width="1.5"/>
      <line x1="155" y1="214" x2="155" y2="230" stroke="#facc15" stroke-width="2.5"/>
      <line x1="162" y1="214" x2="162" y2="230" stroke="#8B4513" stroke-width="2.5"/>
      <line x1="169" y1="214" x2="169" y2="230" stroke="#dc2626" stroke-width="2.5"/>
      <line x1="178" y1="214" x2="178" y2="230" stroke="#facc15" stroke-width="1.5" stroke-dasharray="2"/>
      <text x="166" y="242" text-anchor="middle" class="comp-sublabel">4.7kÎ©</text>
      <!-- pH pot -->
      <rect x="618" y="94" width="48" height="48" rx="6" fill="#0d1f3c" stroke="#f0d060" stroke-width="1.5"/>
      <circle cx="642" cy="118" r="15" fill="#0a1828" stroke="#f0d060" stroke-width="1"/>
      <circle cx="642" cy="118" r="5" fill="#f0d060" opacity="0.8"/>
      <line x1="642" y1="103" x2="642" y2="110" stroke="#f0d060" stroke-width="2" stroke-linecap="round"/>
      <text x="642" y="157" text-anchor="middle" class="comp-label" fill="#f0d060" font-size="9">pH SENSOR</text>
      <text x="642" y="167" text-anchor="middle" class="comp-sublabel">GPIO34</text>
      <line x1="624" y1="142" x2="624" y2="185" stroke="#1e293b" stroke-width="2"/>
      <line x1="642" y1="142" x2="642" y2="185" stroke="#f0d060" stroke-width="2"/>
      <line x1="660" y1="142" x2="660" y2="185" stroke="#dc2626" stroke-width="2"/>
      <text x="624" y="194" text-anchor="middle" class="pin-label">GND</text>
      <text x="642" y="194" text-anchor="middle" class="pin-label" fill="#f0d060">SIG</text>
      <text x="660" y="194" text-anchor="middle" class="pin-label" fill="#dc2626">VCC</text>
      <!-- TDS pot -->
      <rect x="698" y="94" width="48" height="48" rx="6" fill="#0d1f3c" stroke="#ff7b30" stroke-width="1.5"/>
      <circle cx="722" cy="118" r="15" fill="#0a1828" stroke="#ff7b30" stroke-width="1"/>
      <circle cx="722" cy="118" r="5" fill="#ff7b30" opacity="0.8"/>
      <line x1="722" y1="103" x2="722" y2="110" stroke="#ff7b30" stroke-width="2" stroke-linecap="round"/>
      <text x="722" y="157" text-anchor="middle" class="comp-label" fill="#ff7b30" font-size="9">TDS SENSOR</text>
      <text x="722" y="167" text-anchor="middle" class="comp-sublabel">GPIO35</text>
      <line x1="704" y1="142" x2="704" y2="185" stroke="#1e293b" stroke-width="2"/>
      <line x1="722" y1="142" x2="722" y2="185" stroke="#ff7b30" stroke-width="2"/>
      <line x1="740" y1="142" x2="740" y2="185" stroke="#dc2626" stroke-width="2"/>
      <text x="704" y="194" text-anchor="middle" class="pin-label">GND</text>
      <text x="722" y="194" text-anchor="middle" class="pin-label" fill="#ff7b30">SIG</text>
      <text x="740" y="194" text-anchor="middle" class="pin-label" fill="#dc2626">VCC</text>
      <!-- Turbidity pot -->
      <rect x="778" y="94" width="48" height="48" rx="6" fill="#0d1f3c" stroke="#c084fc" stroke-width="1.5"/>
      <circle cx="802" cy="118" r="15" fill="#0a1828" stroke="#c084fc" stroke-width="1"/>
      <circle cx="802" cy="118" r="5" fill="#c084fc" opacity="0.8"/>
      <line x1="802" y1="103" x2="802" y2="110" stroke="#c084fc" stroke-width="2" stroke-linecap="round"/>
      <text x="802" y="157" text-anchor="middle" class="comp-label" fill="#c084fc" font-size="9">TURBIDITY</text>
      <text x="802" y="167" text-anchor="middle" class="comp-sublabel">GPIO32</text>
      <line x1="784" y1="142" x2="784" y2="185" stroke="#1e293b" stroke-width="2"/>
      <line x1="802" y1="142" x2="802" y2="185" stroke="#c084fc" stroke-width="2"/>
      <line x1="820" y1="142" x2="820" y2="185" stroke="#dc2626" stroke-width="2"/>
      <text x="784" y="194" text-anchor="middle" class="pin-label">GND</text>
      <text x="802" y="194" text-anchor="middle" class="pin-label" fill="#c084fc">SIG</text>
      <text x="820" y="194" text-anchor="middle" class="pin-label" fill="#dc2626">VCC</text>
      <!-- Battery -->
      <rect x="55" y="378" width="80" height="34" rx="6" fill="#0d1f3c" stroke="#22c55e" stroke-width="1.5"/>
      <rect x="135" y="389" width="8" height="12" rx="2" fill="#22c55e"/>
      <text x="95" y="393" text-anchor="middle" class="comp-label" fill="#22c55e" font-size="10">18650</text>
      <text x="95" y="404" text-anchor="middle" class="comp-sublabel">3.7V/3000mAh</text>
      <!-- Rails -->
      <line x1="40" y1="458" x2="860" y2="458" stroke="#0d2540" stroke-width="1" stroke-dasharray="5,4" opacity="0.6"/>
      <text x="447" y="470" text-anchor="middle" class="pin-label" fill="#3a5878">GND RAIL</text>
      <line x1="40" y1="443" x2="860" y2="443" stroke="#3b0f0f" stroke-width="1" stroke-dasharray="5,4" opacity="0.6"/>
      <text x="447" y="437" text-anchor="middle" class="pin-label" fill="#dc2626">3.3V RAIL</text>
      <!-- Wires -->
      <polyline points="82,285 82,458" fill="none" stroke="#1e293b" stroke-width="1.5"/>
      <polyline points="114,285 114,443" fill="none" stroke="#dc2626" stroke-width="1.5"/>
      <polyline points="98,285 98,308 200,308 200,222 316,222" fill="none" stroke="#00d4ff" stroke-width="2" filter="url(#glow)"/>
      <text x="175" y="306" class="wire-label" fill="#00d4ff">DATA</text>
      <polyline points="98,308 98,222 136,222" fill="none" stroke="#00d4ff" stroke-width="1.5" opacity="0.5"/>
      <polyline points="196,222 245,222 245,443" fill="none" stroke="#dc2626" stroke-width="1.5" opacity="0.5"/>
      <polyline points="642,185 642,207 579,207 579,192 558,192" fill="none" stroke="#f0d060" stroke-width="2"/>
      <polyline points="624,185 624,458" fill="none" stroke="#1e293b" stroke-width="1.5"/>
      <polyline points="660,185 660,443" fill="none" stroke="#dc2626" stroke-width="1.5"/>
      <polyline points="722,185 722,220 579,220 579,207 558,207" fill="none" stroke="#ff7b30" stroke-width="2"/>
      <polyline points="704,185 704,458" fill="none" stroke="#1e293b" stroke-width="1.5"/>
      <polyline points="740,185 740,443" fill="none" stroke="#dc2626" stroke-width="1.5"/>
      <polyline points="802,185 802,237 579,237 579,222 579,222" fill="none" stroke="#c084fc" stroke-width="2"/>
      <polyline points="579,237 558,237" fill="none" stroke="#c084fc" stroke-width="2"/>
      <polyline points="784,185 784,458" fill="none" stroke="#1e293b" stroke-width="1.5"/>
      <polyline points="820,185 820,443" fill="none" stroke="#dc2626" stroke-width="1.5"/>
      <polyline points="327,192 275,192 275,458" fill="none" stroke="#1e293b" stroke-width="2"/>
      <polyline points="327,207 262,207 262,443" fill="none" stroke="#dc2626" stroke-width="2"/>
      <polyline points="558,222 592,222 592,443" fill="none" stroke="#dc2626" stroke-width="1.5" opacity="0.4"/>
      <polyline points="558,237 598,237 598,458" fill="none" stroke="#1e293b" stroke-width="1.5" opacity="0.4"/>
      <polyline points="55,395 38,395 38,443 55,443" fill="none" stroke="#dc2626" stroke-width="2"/>
      <polyline points="55,405 32,405 32,458 55,458" fill="none" stroke="#1e293b" stroke-width="2"/>
      <circle cx="98" cy="308" r="3" fill="#00d4ff"/>
      <circle cx="275" cy="458" r="3" fill="#1e293b"/>
      <circle cx="262" cy="443" r="3" fill="#dc2626"/>
    </svg>
  </div>
  <div class="legend">
    <div class="legend-item"><div class="legend-line" style="background:#dc2626"></div>3.3V / VCC</div>
    <div class="legend-item"><div class="legend-line" style="background:#1e3a5f"></div>GND</div>
    <div class="legend-item"><div class="legend-line" style="background:#00d4ff"></div>DS18B20 Data (GPIO4)</div>
    <div class="legend-item"><div class="legend-line" style="background:#f0d060"></div>pH Signal (GPIO34)</div>
    <div class="legend-item"><div class="legend-line" style="background:#ff7b30"></div>TDS Signal (GPIO35)</div>
    <div class="legend-item"><div class="legend-line" style="background:#c084fc"></div>Turbidity (GPIO32)</div>
  </div>
  <div class="sec-title">Pin Reference Table</div>
  <table class="pinout-table">
    <tr><th>Component</th><th>Pin</th><th>ESP32 GPIO</th><th>Wire Color</th><th>Notes</th></tr>
    <tr><td>DS18B20</td><td>DQ (Data)</td><td>GPIO 4</td><td>Blue</td><td>Needs 4.7kÎ© pull-up to 3.3V</td></tr>
    <tr><td>DS18B20</td><td>VCC</td><td>3.3V</td><td>Red</td><td>Flat face toward you: right pin</td></tr>
    <tr><td>DS18B20</td><td>GND</td><td>GND</td><td>Black</td><td>Flat face toward you: left pin</td></tr>
    <tr><td>4.7kÎ© Resistor</td><td>Between DQ & VCC</td><td>Pull-up</td><td>Brown</td><td>MANDATORY for DS18B20</td></tr>
    <tr><td>pH Sensor</td><td>Po / SIG</td><td>GPIO 34</td><td>Yellow</td><td>Input-only ADC pin</td></tr>
    <tr><td>TDS Sensor</td><td>AOUT</td><td>GPIO 35</td><td>Orange</td><td>Input-only ADC pin</td></tr>
    <tr><td>Turbidity Sensor</td><td>AOUT</td><td>GPIO 32</td><td>Purple</td><td>ADC capable pin</td></tr>
    <tr><td>All Sensors</td><td>VCC</td><td>3.3V rail</td><td>Red</td><td>Max 3.3V on ADC pins!</td></tr>
    <tr><td>All Sensors</td><td>GND</td><td>GND rail</td><td>Black</td><td>Common ground required</td></tr>
    <tr><td>18650 Battery</td><td>+ terminal</td><td>VIN</td><td>Red</td><td>For portable use only</td></tr>
  </table>
</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SIMULATION TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="tab-sim" class="tab-content">
<div class="sim-grid">
  <div class="controls-panel">
    <div class="sec-title">Live Sensor Readings</div>
    <div class="sensors-grid">
      <div class="sensor-card" id="card-ph">
        <div class="sensor-label">pH Level</div>
        <div style="font-size:18px;margin-bottom:5px">ğŸ§ª</div>
        <div class="sensor-value" id="val-ph">7.00</div>
        <div class="sensor-unit">pH Units (0â€“14)</div>
        <div class="sensor-status" id="status-ph">NORMAL</div>
      </div>
      <div class="sensor-card" id="card-tds">
        <div class="sensor-label">TDS</div>
        <div style="font-size:18px;margin-bottom:5px">âš—ï¸</div>
        <div class="sensor-value" id="val-tds">250</div>
        <div class="sensor-unit">ppm</div>
        <div class="sensor-status" id="status-tds">NORMAL</div>
      </div>
      <div class="sensor-card" id="card-turb">
        <div class="sensor-label">Turbidity</div>
        <div style="font-size:18px;margin-bottom:5px">ğŸŒŠ</div>
        <div class="sensor-value" id="val-turb">1.5</div>
        <div class="sensor-unit">NTU</div>
        <div class="sensor-status" id="status-turb">CLEAR</div>
      </div>
      <div class="sensor-card" id="card-temp">
        <div class="sensor-label">Temperature</div>
        <div style="font-size:18px;margin-bottom:5px">ğŸŒ¡ï¸</div>
        <div class="sensor-value" id="val-temp">25.0</div>
        <div class="sensor-unit">Â°C (DS18B20)</div>
        <div class="sensor-status" id="status-temp">NORMAL</div>
      </div>
    </div>
    <div class="sec-title">Adjust Inputs (simulates potentiometer knobs in Wokwi)</div>
    <div class="slider-block">
      <div class="slider-header"><span class="slider-name">ğŸ§ª pH <span style="font-size:10px;color:var(--dim)">[GPIO34]</span></span><span class="slider-readout" id="r-ph">7.0</span></div>
      <input type="range" id="s-ph" min="0" max="14" step="0.1" value="7.0" oninput="update()">
      <div class="tick-labels"><span>0 (Acid)</span><span>7 Neutral</span><span>14 (Base)</span></div>
    </div>
    <div class="slider-block">
      <div class="slider-header"><span class="slider-name">âš—ï¸ TDS <span style="font-size:10px;color:var(--dim)">[GPIO35]</span></span><span class="slider-readout" id="r-tds">250 ppm</span></div>
      <input type="range" id="s-tds" min="0" max="1200" step="5" value="250" oninput="update()">
      <div class="tick-labels"><span>0</span><span>500 limit</span><span>1200</span></div>
    </div>
    <div class="slider-block">
      <div class="slider-header"><span class="slider-name">ğŸŒŠ Turbidity <span style="font-size:10px;color:var(--dim)">[GPIO32]</span></span><span class="slider-readout" id="r-turb">1.5 NTU</span></div>
      <input type="range" id="s-turb" min="0" max="100" step="0.5" value="1.5" oninput="update()">
      <div class="tick-labels"><span>0</span><span>4 NTU limit</span><span>100</span></div>
    </div>
    <div class="slider-block">
      <div class="slider-header"><span class="slider-name">ğŸŒ¡ï¸ Temperature <span style="font-size:10px;color:var(--dim)">[GPIO4 DS18B20]</span></span><span class="slider-readout" id="r-temp">25.0 Â°C</span></div>
      <input type="range" id="s-temp" min="0" max="60" step="0.5" value="25" oninput="update()">
      <div class="tick-labels"><span>0Â°C</span><span>25Â°C</span><span>60Â°C</span></div>
    </div>
  </div>
  <div class="report-panel">
    <div class="sec-title">Water Quality Report</div>
    <div class="overall-badge safe" id="overall-badge">
      <div class="badge-emoji" id="badge-emoji">âœ…</div>
      <div class="badge-title" id="badge-title">SAFE TO DRINK</div>
      <div class="badge-sub" id="badge-sub">All parameters within WHO safe range</div>
    </div>
    <div class="wqi-bar">
      <div class="wqi-label"><span style="font-size:10px;color:var(--dim);letter-spacing:2px">WATER QUALITY INDEX</span><span id="wqi-val" style="font-family:'Share Tech Mono',monospace;color:var(--accent)">87</span></div>
      <div class="wqi-track"><div class="wqi-fill" id="wqi-fill" style="width:87%"></div></div>
    </div><br>
    <table class="report-table">
      <tr><td>pH</td><td id="rph">7.0</td><td><span class="tag safe" id="tph">NEUTRAL</span></td></tr>
      <tr><td>TDS</td><td id="rtds">250 ppm</td><td><span class="tag safe" id="ttds">GOOD</span></td></tr>
      <tr><td>Turbidity</td><td id="rturb">1.5 NTU</td><td><span class="tag safe" id="tturb">CLEAR</span></td></tr>
      <tr><td>Temp</td><td id="rtemp">25.0 Â°C</td><td><span class="tag safe" id="ttemp">NORMAL</span></td></tr>
      <tr><td>WHO pH</td><td>6.5 â€“ 8.5</td><td><span style="font-size:9px;color:var(--dim2)">Safe limit</span></td></tr>
      <tr><td>WHO TDS</td><td>&lt; 500 ppm</td><td><span style="font-size:9px;color:var(--dim2)">Safe limit</span></td></tr>
      <tr><td>WHO Turb</td><td>&lt; 4 NTU</td><td><span style="font-size:9px;color:var(--dim2)">Safe limit</span></td></tr>
    </table>
    <div class="sec-title">Serial Monitor</div>
    <div class="serial-monitor" id="serial">
      <div class="serial-header">â— COM3 Â· 115200 BAUD Â· ESP32 DevKit V1</div>
    </div>
  </div>
</div>
</div>

<script>
// â”€â”€ Tab switching â”€â”€
function switchTab(t){
  document.querySelectorAll('.tab').forEach((el,i)=>el.classList.toggle('active',['guide','circuit','sim'][i]===t));
  ['guide','circuit','sim'].forEach(id=>document.getElementById('tab-'+id).classList.toggle('active',id===t));
}

// â”€â”€ PDF Download via Print Dialog â”€â”€
function downloadPDF(){
  const ph   = parseFloat(document.getElementById('s-ph').value);
  const tds  = parseFloat(document.getElementById('s-tds').value);
  const turb = parseFloat(document.getElementById('s-turb').value);
  const temp = parseFloat(document.getElementById('s-temp').value);
  const wqi  = parseInt(document.getElementById('wqi-val').textContent)||87;
  const status = document.getElementById('badge-title').textContent||'SAFE TO DRINK';
  const now  = new Date().toLocaleString();

  const phS  = ph<6.5?'ACIDIC':ph>8.5?'ALKALINE':'NORMAL';
  const tdsS = tds<50?'TOO LOW':tds>500?'HIGH':'NORMAL';
  const turbS= turb>4?'CLOUDY':turb>2?'HAZY':'CLEAR';
  const tempS= temp>35?'HOT':temp<5?'COLD':'NORMAL';

  const isSafe = (v,min,max)=>v>=min&&v<=max;
  const rowColor=(ok)=>ok?'#007700':'#cc0000';

  // Fill date fields
  document.getElementById('pdf-date').textContent = now;
  document.getElementById('pdf-footer-date').textContent = now;
  document.getElementById('pdf-wqi').textContent = wqi;

  // Badge
  const isGood = status.includes('SAFE');
  const isMarg = status.includes('MARGINAL');
  const badge = document.getElementById('pdf-badge');
  badge.style.borderColor = isGood?'#00aa66':isMarg?'#cc8800':'#cc0000';
  badge.style.background  = isGood?'#f0fff8':isMarg?'#fffdf0':'#fff5f5';
  document.getElementById('pdf-badge-emoji').textContent = isGood?'âœ…':isMarg?'âš ï¸':'âŒ';
  document.getElementById('pdf-badge-title').textContent = status;
  document.getElementById('pdf-badge-title').style.color = isGood?'#00aa66':isMarg?'#cc8800':'#cc0000';
  document.getElementById('pdf-badge-sub').textContent = document.getElementById('badge-sub').textContent;

  // Table rows
  const rows = [
    {name:'pH Level',     val:ph.toFixed(2),      unit:'pH units', status:phS,  range:'6.5 â€“ 8.5',        sensor:'Analog pH Module / GPIO34', ok:isSafe(ph,6.5,8.5)},
    {name:'TDS',          val:tds.toFixed(0),      unit:'ppm',      status:tdsS, range:'50 â€“ 500 ppm',     sensor:'TDS Module / GPIO35',       ok:isSafe(tds,50,500)},
    {name:'Turbidity',    val:turb.toFixed(1),     unit:'NTU',      status:turbS,range:'0 â€“ 4 NTU',        sensor:'Turbidity Sensor / GPIO32', ok:turb<=4},
    {name:'Temperature',  val:temp.toFixed(1),     unit:'Â°C',       status:tempS,range:'5 â€“ 30 Â°C',        sensor:'DS18B20 Probe / GPIO4',     ok:isSafe(temp,5,30)},
  ];
  const tbody = document.getElementById('pdf-table-body');
  tbody.innerHTML = rows.map((r,i)=>`
    <tr style="background:${i%2===0?'#ffffff':'#f9f9f9'}">
      <td style="padding:9px 12px;border:1px solid #ddd;font-weight:600;">${r.name}</td>
      <td style="padding:9px 12px;border:1px solid #ddd;font-family:monospace;font-size:14px;font-weight:700;">${r.val} <span style="font-size:11px;font-weight:400;color:#777;">${r.unit}</span></td>
      <td style="padding:9px 12px;border:1px solid #ddd;font-weight:700;color:${rowColor(r.ok)};">${r.ok?'âœ… '+r.status:'âš ï¸ '+r.status}</td>
      <td style="padding:9px 12px;border:1px solid #ddd;color:#555;font-size:12px;">${r.range}</td>
      <td style="padding:9px 12px;border:1px solid #ddd;color:#777;font-size:11px;">${r.sensor}</td>
    </tr>`).join('');

  // Analysis text
  document.getElementById('pdf-analysis').innerHTML = [
    `<p style="margin-bottom:8px;padding:8px 12px;background:${isSafe(ph,6.5,8.5)?'#f0fff8':'#fff8f0'};border-left:3px solid ${isSafe(ph,6.5,8.5)?'#00aa66':'#cc6600'};border-radius:0 4px 4px 0;">
      <strong>pH ${ph.toFixed(2)}:</strong> ${ph<6.5?'Acidic water below safe range. Can corrode pipes and leach heavy metals (lead, copper) into water supply. Treat with neutralizing filters.':ph>8.5?'Alkaline water above safe range. Reduces chlorine disinfection effectiveness. May cause bitter taste and gastrointestinal irritation.':'pH is within WHO safe range (6.5â€“8.5). Neutral water â€” suitable for drinking.'}</p>`,
    `<p style="margin-bottom:8px;padding:8px 12px;background:${isSafe(tds,50,500)?'#f0fff8':'#fff8f0'};border-left:3px solid ${isSafe(tds,50,500)?'#00aa66':'#cc6600'};border-radius:0 4px 4px 0;">
      <strong>TDS ${tds.toFixed(0)} ppm:</strong> ${tds<50?'TDS too low. Water may lack essential minerals. Prolonged consumption of demineralized water can lead to mineral deficiencies. Consider remineralization.':tds>500?'TDS exceeds WHO acceptable limit of 500 ppm. May indicate dissolved contaminants, heavy metals, or excessive salts. Treat with reverse osmosis or distillation.':'TDS within acceptable WHO range (50â€“500 ppm). Adequate mineral content for healthy drinking water.'}</p>`,
    `<p style="margin-bottom:8px;padding:8px 12px;background:${turb<=4?'#f0fff8':'#fff8f0'};border-left:3px solid ${turb<=4?'#00aa66':'#cc6600'};border-radius:0 4px 4px 0;">
      <strong>Turbidity ${turb.toFixed(1)} NTU:</strong> ${turb>4?'Water cloudiness exceeds WHO limit of 4 NTU. Suspended particles can shield pathogens from UV/chlorine disinfection. Filter through sand or membrane filter before use.':turb>2?'Slightly hazy. Within limit but approaching threshold. Monitor for changes. Consider filtration.':'Water is visually clear. Turbidity within WHO safe range (<4 NTU). Low particle count.'}</p>`,
    `<p style="margin-bottom:8px;padding:8px 12px;background:${isSafe(temp,5,30)?'#f0fff8':'#fff8f0'};border-left:3px solid ${isSafe(temp,5,30)?'#00aa66':'#cc6600'};border-radius:0 4px 4px 0;">
      <strong>Temperature ${temp.toFixed(1)} Â°C:</strong> ${temp>35?'Temperature dangerously high. Bacterial growth accelerates above 35Â°C (Legionella thrives at 25â€“45Â°C). Disinfect and cool water before use.':temp<5?'Temperature very cold. Risk of pipe freezing and burst. Bacterial growth suppressed but not eliminated.':'Temperature within safe range (5â€“30Â°C). Suitable conditions â€” low bacterial multiplication risk.'}</p>`
  ].join('');

  // Show PDF div and print
  const el = document.getElementById('pdf-report');
  el.style.display = 'block';
  setTimeout(()=>{
    window.print();
    setTimeout(()=>{ el.style.display='none'; }, 1000);
  }, 200);
}

// â”€â”€ Simulation logic â”€â”€
const serial=document.getElementById('serial');
function addLog(lines){
  lines.forEach(({text,cls})=>{
    const d=document.createElement('div');
    d.className='serial-line '+(cls||'sdim');
    d.textContent=text;
    serial.appendChild(d);
  });
  serial.scrollTop=serial.scrollHeight;
  if(serial.children.length>90) while(serial.children.length>65) serial.removeChild(serial.children[1]);
}
function calcWQI(ph,tds,turb,temp){
  let s=100;
  if(ph<6.5||ph>8.5)s-=25;else if(ph<7||ph>8)s-=8;
  if(tds>500)s-=25;else if(tds>300)s-=8;
  if(turb>4)s-=30;else if(turb>2)s-=10;
  if(temp>35||temp<5)s-=20;
  return Math.max(0,s);
}
function update(){
  const ph=parseFloat(document.getElementById('s-ph').value);
  const tds=parseFloat(document.getElementById('s-tds').value);
  const turb=parseFloat(document.getElementById('s-turb').value);
  const temp=parseFloat(document.getElementById('s-temp').value);
  document.getElementById('r-ph').textContent=ph.toFixed(1);
  document.getElementById('r-tds').textContent=tds.toFixed(0)+' ppm';
  document.getElementById('r-turb').textContent=turb.toFixed(1)+' NTU';
  document.getElementById('r-temp').textContent=temp.toFixed(1)+' Â°C';
  const phR=ph<6.5?{cls:'warn',label:'ACIDIC'}:ph>8.5?{cls:'warn',label:'ALKALINE'}:{cls:'safe',label:'NEUTRAL'};
  const tdsR=tds<50?{cls:'warn',label:'TOO LOW'}:tds>500?{cls:'danger',label:'HIGH'}:{cls:'safe',label:'GOOD'};
  const turbR=turb>4?{cls:'danger',label:'CLOUDY'}:turb>2?{cls:'warn',label:'HAZY'}:{cls:'safe',label:'CLEAR'};
  const tempR=temp>35?{cls:'danger',label:'HOT'}:temp<5?{cls:'warn',label:'COLD'}:{cls:'safe',label:'NORMAL'};
  const setCard=(id,val,r)=>{
    document.getElementById('val-'+id).textContent=id==='ph'?val.toFixed(2):id==='turb'?val.toFixed(1):val.toFixed(0);
    const st=document.getElementById('status-'+id);
    st.textContent=r.label;st.className='sensor-status '+r.cls;
    document.getElementById('card-'+id).className='sensor-card '+r.cls;
    document.getElementById('val-'+id).style.color=r.cls==='safe'?'var(--accent2)':r.cls==='warn'?'var(--warn)':'var(--danger)';
  };
  setCard('ph',ph,phR);setCard('tds',tds,tdsR);setCard('turb',turb,turbR);setCard('temp',temp,tempR);
  document.getElementById('rph').textContent=ph.toFixed(2);
  document.getElementById('rtds').textContent=tds.toFixed(0)+' ppm';
  document.getElementById('rturb').textContent=turb.toFixed(1)+' NTU';
  document.getElementById('rtemp').textContent=temp.toFixed(1)+' Â°C';
  const setTag=(id,r)=>{const t=document.getElementById(id);t.textContent=r.label;t.className='tag '+r.cls;};
  setTag('tph',phR);setTag('ttds',tdsR);setTag('tturb',turbR);setTag('ttemp',tempR);
  const issues=[phR,tdsR,turbR,tempR].filter(r=>r.cls!=='safe').length;
  const wqi=calcWQI(ph,tds,turb,temp);
  const badge=document.getElementById('overall-badge');
  badge.className='overall-badge '+(issues===0?'safe':issues<=1?'warn':'danger');
  document.getElementById('badge-emoji').textContent=issues===0?'âœ…':issues<=1?'âš ï¸':'âŒ';
  document.getElementById('badge-title').textContent=issues===0?'SAFE TO DRINK':issues<=1?'MARGINAL â€” Treat before use':'UNSAFE â€” Do NOT drink';
  document.getElementById('badge-sub').textContent=issues===0?'All parameters within WHO safe range':`${issues} parameter${issues>1?'s':''} out of safe range`;
  document.getElementById('wqi-val').textContent=wqi;
  document.getElementById('wqi-fill').style.width=wqi+'%';
  const now=new Date();
  const ts=`[${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}:${String(now.getSeconds()).padStart(2,'0')}]`;
  addLog([
    {text:`${ts} ===== WATER QUALITY REPORT =====`,cls:'shead'},
    {text:`  pH         : ${ph.toFixed(2)}   â†’ ${phR.label}`,cls:phR.cls==='safe'?'snew':phR.cls==='warn'?'swarn':'sdanger'},
    {text:`  TDS        : ${tds.toFixed(0)} ppm â†’ ${tdsR.label}`,cls:tdsR.cls==='safe'?'snew':tdsR.cls==='warn'?'swarn':'sdanger'},
    {text:`  Turbidity  : ${turb.toFixed(1)} NTU â†’ ${turbR.label}`,cls:turbR.cls==='safe'?'snew':turbR.cls==='warn'?'swarn':'sdanger'},
    {text:`  Temp       : ${temp.toFixed(1)} C   â†’ ${tempR.label}`,cls:tempR.cls==='safe'?'snew':tempR.cls==='warn'?'swarn':'sdanger'},
    {text:`  WQI Score  : ${wqi}/100`,cls:wqi>70?'snew':wqi>40?'swarn':'sdanger'},
    {text:`  STATUS     : ${issues===0?'SAFE TO DRINK':issues<=1?'MARGINAL':'UNSAFE'}`,cls:issues===0?'snew':issues<=1?'swarn':'sdanger'},
    {text:`${ts} ================================`,cls:'shead'},
  ]);
}
addLog([
  {text:'[BOOT] ESP32 AquaMonitor v1.0 starting...',cls:'shead'},
  {text:'[BOOT] ADC 12-bit resolution initialized',cls:'snew'},
  {text:'[BOOT] DS18B20 on GPIO4 â†’ detected âœ“',cls:'snew'},
  {text:'[BOOT] pH sensor on GPIO34 â†’ ready âœ“',cls:'snew'},
  {text:'[BOOT] TDS sensor on GPIO35 â†’ ready âœ“',cls:'snew'},
  {text:'[BOOT] Turbidity on GPIO32 â†’ ready âœ“',cls:'snew'},
  {text:'[BOOT] Scanning every 3 seconds...',cls:'sdim'},
]);
update();
</script>
</body>
</html>
